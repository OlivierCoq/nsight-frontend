import{h as J,_ as q}from"./moment.XRzeILc3.js";import{H as z,n as B,h as k,q as d,o as f,s as U,w as t,b as e,I as s,d as w,c as $,x as N,F as x,v as D,u as Y,t as F,p as Z,e as G,a as j,y as H,_ as W}from"./entry.edFZpnpL.js";import{u as K,a as I}from"./auth.mQ8edLOI.js";const P=v=>(Z("data-v-02f149d0"),v=v(),G(),v),Q={key:0},ee=P(()=>j("strong",{style:{"font-size":"200%"}},"+",-1)),ae=P(()=>j("span",{class:"headline"},"invite new member",-1)),te=z({__name:"dashboard_legacy",setup(v){const c=H(),R=K(),_=I(),a=B({current_user:I.user,current_tab:null,dark_mode:!1,error:!1,use_the_force:!1,tabs:[{name:"My Profile",data:{}},{name:"My Members",data:{adding_new:!1,posting_new:!1,post:null,new_member:{email:"",first_name:"",last_name:"",n_id:`nsight-${_.user.id}-${J().format("MMDDYYYY-hmmss")}`}}}],validate:!1}),L=o=>o.toString().toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),M=async()=>{let o=a.tabs[1];o.data.posting_new=!0,o.post=await $fetch(`${c.public.NUXT_STRAPI_URL}/api/nsight-ids?populate=*`,{method:"GET",headers:{"Content-Type":"application/json",accept:"application/json"}}).then(n=>{const g=n;let y;if(g.data.forEach(b=>{o.data.new_member.n_id===b.attributes.nsight_id&&(y=!0)}),y)return console.log("Invalid."),!1;{let b={data:{authentic:!0,nsight_id:o.data.new_member.n_id}};$fetch(`${c.public.NUXT_STRAPI_URL}/api/nsight-ids`,{method:"POST",headers:{"Content-Type":"application/json",accept:"application/json"},body:JSON.stringify(b)}).then(u=>{console.log("new_nsight_id",u);let r={blocked:!1,confirmed:!1,email:o.data.new_member.email,first_name:o.data.new_member.first_name,last_name:o.data.new_member.last_name,nsight_id:u.data,preferences:{dark_mode:!0},username:o.data.new_member.email,password:"P@ssW3rd9756",users:[_.user]};$fetch(`${c.public.NUXT_STRAPI_URL}/api/users`,{method:"POST",headers:{"Content-Type":"application/json",accept:"application/json"},body:JSON.stringify(r)}).then(m=>{console.log("created new member: ",m);const h=m;R.customers.create({first_name:r.first_name,last_name:r.last_name,password:r.password,email:r.email}).then(i=>{console.log("added to Medusa: ",i),r.medusa_id=i.customer.id,$fetch(`${c.public.NUXT_STRAPI_URL}/api/users/${h.id}`,{method:"PUT",headers:{"Content-Type":"application/json",accept:"application/json"},body:JSON.stringify(r)}).then(p=>{}).catch(p=>{})}).catch(i=>{console.log("Medusa error",i)}),_.user.friends.push(m),a.tabs[1].data.adding_new=!1,$fetch(`${c.public.NUXT_STRAPI_URL}/api/auth/send-email-confirmation`,{method:"POST",headers:{"Content-Type":"application/json",accept:"application/json"},body:JSON.stringify({email:o.data.new_member.email})}).then(i=>{$fetch(`${c.public.NUXT_STRAPI_URL}/api/users/${_.user.id}`,{method:"PUT",headers:{"Content-Type":"application/json",accept:"application/json"},body:JSON.stringify(_.user)}).then(p=>{o.data.posting_new=!1,o.data.adding_new=!1}).catch(p=>{a.error=p})}).catch(i=>{a.error=i})}).catch(m=>{a.error=m})}).catch(u=>{a.error=u})}}).catch(n=>{a.error=n})};return k(()=>a.tabs[1].data.new_member.email,o=>{a.validate=o.length>0&&L(o)}),k(()=>a.tabs[1].data.new_member.first_name,o=>{a.validate=o.length>0}),(o,n)=>{const g=d("v-card-title"),y=d("v-tab"),b=d("v-tabs"),u=q,r=d("v-col"),m=d("v-tooltip"),h=d("v-text-field"),i=d("v-row"),p=d("v-form"),T=d("v-card-text"),A=d("v-spacer"),V=d("v-btn"),O=d("v-card-actions"),C=d("v-card"),X=d("v-dialog"),E=d("v-window");return f(),U(i,{id:"dashboard",class:Y(s(_).user.preferences.dark_mode?"bg-dark":"bg-light")},{default:t(()=>[e(r,{class:"h-100"},{default:t(()=>[e(C,{theme:s(_).user.preferences.dark_mode?"dark":"light",class:"mx-3 my-3 h-100 overflow-auto"},{default:t(()=>[e(g,null,{default:t(()=>[w("let's get it")]),_:1}),e(T,null,{default:t(()=>[e(b,{modelValue:s(a).current_tab,"onUpdate:modelValue":n[0]||(n[0]=l=>s(a).current_tab=l)},{default:t(()=>[(f(!0),$(x,null,N(s(a).tabs,(l,S)=>(f(),U(y,{key:S},{default:t(()=>[w(F(l.name),1)]),_:2},1024))),128))]),_:1},8,["modelValue"]),e(E,{modelValue:s(a).current_tab,"onUpdate:modelValue":n[7]||(n[7]=l=>s(a).current_tab=l)},{default:t(()=>[s(a).current_tab==1?(f(),$("div",Q,[e(i,{class:"my-3"},{default:t(()=>[(f(!0),$(x,null,N(s(_).user.users,(l,S)=>(f(),U(r,{key:S,cols:"12",sm:"6",md:"3",lg:"2",xl:"1"},{default:t(()=>[e(u,{member:l},null,8,["member"])]),_:2},1024))),128)),e(r,{cols:"12",sm:"6",md:"3",lg:"2",xl:"1"},{default:t(()=>[e(C,{variant:"tonal",class:"w-100 h-100"},{default:t(()=>[e(T,{class:"d-flex w-100 h-100 justify-center align-center"},{default:t(()=>[e(V,{onClick:n[6]||(n[6]=l=>s(a).tabs[1].data.adding_new=!0),flat:""},{default:t(()=>[ee,e(m,{activator:"parent",location:"top","open-delay":"500"},{default:t(()=>[w("Invite new member")]),_:1}),e(X,{modelValue:s(a).tabs[1].data.adding_new,"onUpdate:modelValue":n[5]||(n[5]=l=>s(a).tabs[1].data.adding_new=l),width:"600"},{default:t(()=>[e(i,null,{default:t(()=>[e(r,null,{default:t(()=>[e(C,{flat:"",variant:"flat"},{default:t(()=>[e(g,null,{default:t(()=>[ae]),_:1}),e(T,null,{default:t(()=>[e(p,null,{default:t(()=>[e(i,null,{default:t(()=>[e(r,null,{default:t(()=>[e(h,{modelValue:s(a).tabs[1].data.new_member.first_name,"onUpdate:modelValue":n[1]||(n[1]=l=>s(a).tabs[1].data.new_member.first_name=l),label:"First Name",required:""},null,8,["modelValue"])]),_:1}),e(r,null,{default:t(()=>[e(h,{modelValue:s(a).tabs[1].data.new_member.last_name,"onUpdate:modelValue":n[2]||(n[2]=l=>s(a).tabs[1].data.new_member.last_name=l),label:"Last Name",required:""},null,8,["modelValue"])]),_:1})]),_:1}),e(h,{modelValue:s(a).tabs[1].data.new_member.email,"onUpdate:modelValue":n[3]||(n[3]=l=>s(a).tabs[1].data.new_member.email=l),label:"Email",required:""},null,8,["modelValue"])]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(A),e(V,{color:"blue darken-1",text:"",onClick:n[4]||(n[4]=l=>s(a).tabs[1].data.adding_new=!1)},{default:t(()=>[w("Cancel")]),_:1}),e(V,{disabled:!s(a).validate,color:"blue darken-1",text:"",onClick:M},{default:t(()=>[w("Invite")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])):D("",!0)]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["theme"])]),_:1})]),_:1},8,["class"])}}}),le=W(te,[["__scopeId","data-v-02f149d0"]]);export{le as default};
